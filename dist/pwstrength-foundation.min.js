/*!
* jQuery Password Strength plugin for Zurb Foundation
* 2015-10-05
*
* Copyright (c) 2008-2013 Tane Piper
* Copyright (c) 2013 Alejandro Blanco
* Copyright (c) 2014 Ed Townend
* Dual licensed under the MIT and GPL licenses.
*/
!function(r){var e={}
try{if(!r&&module&&module.exports){var r=require("jquery"),o=require("jsdom").jsdom
r=r(o().parentWindow)}}catch(r){}!function(r,e){"use strict"
var o={}
e.forbiddenSequences=["0123456789","abcdefghijklmnopqrstuvwxyz","qwertyuiop","asdfghjkl","zxcvbnm","!@#$%^&*()_+"],o.wordNotEmail=function(r,e,o){return e.match(/^([\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+\.)*[\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+@((((([a-z0-9]{1}[a-z0-9\-]{0,62}[a-z0-9]{1})|[a-z])\.)+[a-z]{2,6})|(\d{1,3}\.){3}\d{1,3}(\:\d{1,5})?)$/i)?o:0},o.wordLength=function(r,e,o){var s=e.length,t=Math.pow(s,r.rules.raisePower)
return s<r.common.minChar&&(t+=o),t},o.wordSimilarToUsername=function(e,o,s){var t=r(e.common.usernameField).val()
return t&&o.toLowerCase().match(t.replace(/[\-\[\]\/\{\}\(\)\*\+\=\?\:\.\\\^\$\|\!\,]/g,"\\$&").toLowerCase())?s:0},o.wordTwoCharacterClasses=function(r,e,o){return e.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)||e.match(/([a-zA-Z])/)&&e.match(/([0-9])/)||e.match(/(.[!,@,#,$,%,\^,&,*,?,_,~])/)&&e.match(/[a-zA-Z0-9_]/)?o:0},o.wordRepetitions=function(r,e,o){return e.match(/(.)\1\1/)?o:0},o.wordSequences=function(o,s,t){var n,i=!1
return s.length>2&&(r.each(e.forbiddenSequences,function(e,o){if(!i){var t=[o,o.split("").reverse().join("")]
r.each(t,function(r,e){for(n=0;n<s.length-2;n+=1)e.indexOf(s.toLowerCase().substring(n,n+3))>-1&&(i=!0)})}}),i)?t:0},o.wordLowercase=function(r,e,o){return e.match(/[a-z]/)&&o},o.wordUppercase=function(r,e,o){return e.match(/[A-Z]/)&&o},o.wordOneNumber=function(r,e,o){return e.match(/\d+/)&&o},o.wordThreeNumbers=function(r,e,o){return e.match(/(.*[0-9].*[0-9].*[0-9])/)&&o},o.wordOneSpecialChar=function(r,e,o){return e.match(/[!,@,#,$,%,\^,&,*,?,_,~]/)&&o},o.wordTwoSpecialChar=function(r,e,o){return e.match(/(.*[!,@,#,$,%,\^,&,*,?,_,~].*[!,@,#,$,%,\^,&,*,?,_,~])/)&&o},o.wordUpperLowerCombo=function(r,e,o){return e.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&o},o.wordLetterNumberCombo=function(r,e,o){return e.match(/([a-zA-Z])/)&&e.match(/([0-9])/)&&o},o.wordLetterNumberCharCombo=function(r,e,o){return e.match(/([a-zA-Z0-9].*[!,@,#,$,%,\^,&,*,?,_,~])|([!,@,#,$,%,\^,&,*,?,_,~].*[a-zA-Z0-9])/)&&o},e.validation=o,e.executeRules=function(o,s){var t=0
return r.each(o.rules.activated,function(n,i){if(i){var a,c,u=o.rules.scores[n],d=e.validation[n]
r.isFunction(d)||(d=o.rules.extra[n]),r.isFunction(d)&&(a=d(o,s,u),a&&(t+=a),(a<0||!r.isNumeric(a)&&!a)&&(c=o.ui.spanError(o,n),c.length>0&&o.instances.errors.push(c)))}}),t}}(r,e)
try{module&&module.exports&&(module.exports=e)}catch(r){}var s={}
s.common={},s.common.minChar=6,s.common.usernameField="#username",s.common.userInputs=[],s.common.onLoad=void 0,s.common.onKeyUp=void 0,s.common.zxcvbn=!1,s.common.zxcvbnTerms=[],s.common.debug=!1,s.rules={},s.rules.extra={},s.rules.scores={wordNotEmail:-100,wordLength:-50,wordSimilarToUsername:-100,wordSequences:-20,wordTwoCharacterClasses:2,wordRepetitions:-25,wordLowercase:1,wordUppercase:3,wordOneNumber:3,wordThreeNumbers:5,wordOneSpecialChar:3,wordTwoSpecialChar:5,wordUpperLowerCombo:2,wordLetterNumberCombo:2,wordLetterNumberCharCombo:2},s.rules.activated={wordNotEmail:!0,wordLength:!0,wordSimilarToUsername:!0,wordSequences:!0,wordTwoCharacterClasses:!1,wordRepetitions:!1,wordLowercase:!0,wordUppercase:!0,wordOneNumber:!0,wordThreeNumbers:!0,wordOneSpecialChar:!0,wordTwoSpecialChar:!0,wordUpperLowerCombo:!0,wordLetterNumberCombo:!0,wordLetterNumberCharCombo:!0},s.rules.raisePower=1.4,s.ui={},s.ui.colorClasses=["alert","warning","success"],s.ui.showProgressBar=!0,s.ui.showPopover=!1,s.ui.popoverPlacement="bottom",s.ui.showStatus=!1,s.ui.spanError=function(r,e){"use strict"
var o=r.ui.errorMessages[e]
return o?o:""},s.ui.popoverError=function(e){"use strict"
var o="<div>Errors:<ul class='error-list' style='margin-bottom: 0;'>"
return r.each(e,function(r,e){o+="<li>"+e+"</li>"}),o+="</ul></div>"},s.ui.errorMessages={wordLength:"Your password is too short",wordNotEmail:"Do not use your email as your password",wordSimilarToUsername:"Your password cannot contain your username",wordTwoCharacterClasses:"Use different character classes",wordRepetitions:"Too many repetitions",wordSequences:"Your password contains sequences"},s.ui.verdicts=["Weak","Normal","Medium","Strong","Very Strong"],s.ui.showVerdicts=!0,s.ui.showVerdictsInsideProgressBar=!1,s.ui.useVerdictCssClass=!1,s.ui.showErrors=!1,s.ui.container=void 0,s.ui.viewports={progress:void 0,verdict:".postfix",errors:void 0},s.ui.scores=[14,26,38,50]
var t={}
!function(r,e){"use strict"
var o=["error","warning","success"]
e.getContainer=function(r,e){var o
return o=e.parents(r.ui.container),o&&1===o.length||(o=e.parent()),o},e.findElement=function(r,e,o){return e?r.find(e).find(o):r.find(o)},e.getUIElements=function(r,o){var s,t
return r.instances.viewports?r.instances.viewports:(s=e.getContainer(r,o),t={},t.$progressbar=e.findElement(s,r.ui.viewports.progress,"div.progress"),r.ui.showVerdictsInsideProgressBar&&(t.$verdict=t.$progressbar.find("span.password-verdict")),r.ui.showPopover||(r.ui.showVerdictsInsideProgressBar||(t.$verdict=e.findElement(s,r.ui.viewports.verdict,"span.password-verdict")),t.$errors=e.findElement(s,r.ui.viewports.errors,"small.error")),r.instances.viewports=t,t)},e.initProgressBar=function(o,s){var t=e.getContainer(o,s),n="<div class='progress' role='progress'><div class='progress-meter' style='width:0%'>"
o.ui.showVerdictsInsideProgressBar&&(n+="<span class='password-verdict'></span>"),n+="</div></div>",o.ui.viewports.progress?t.find(o.ui.viewports.progress).append(n):r(n).insertAfter(s)},e.initHelper=function(o,s,t,n){var i=e.getContainer(o,s)
n?i.find(n).append(t):r(t).insertAfter(s)},e.initVerdict=function(r,o){e.initHelper(r,o,"<span class='password-verdict'></span>",r.ui.viewports.verdict)},e.initErrorList=function(r,o){var s=e.getContainer(r,o)
e.findElement(s,r.ui.viewports.errors,"small.error").length||e.initHelper(r,o,"<small class='error' style='display:none;'></small>",r.ui.viewports.errors)},e.initPopover=function(r,e){return!1},e.initUI=function(r,o){r.ui.showPopover?e.initPopover(r,o):(r.ui.showErrors&&e.initErrorList(r,o),r.ui.showVerdicts&&!r.ui.showVerdictsInsideProgressBar&&e.initVerdict(r,o)),r.ui.showProgressBar&&e.initProgressBar(r,o)},e.possibleProgressBarClasses=["alert","warning","success"],e.updateProgressBar=function(o,s,t,n){var i=e.getUIElements(o,s).$progressbar,a=i.find(".progress-meter")
r.each(o.ui.colorClasses,function(r,e){i.removeClass(e)}),i.addClass(o.ui.colorClasses[t]),a.css("width",n+"%")},e.updateVerdict=function(r,o,s,t){var n=e.getUIElements(r,o).$verdict
n.removeClass(r.ui.colorClasses.join(" ")),s>-1&&n.addClass(r.ui.colorClasses[s]),n.html(t)},e.updateErrors=function(o,s){var t=e.getContainer(o,s),n=e.getUIElements(o,s).$errors,i=""
r.each(o.instances.errors,function(r,e){i+=e+"<br>"}),""!==i?(t.addClass("error"),n.show()):(t.removeClass("error"),n.hide()),n.html(i)},e.updatePopover=function(r,e,o){var s=e.data("bs.popover"),t="",n=!0
return r.ui.showVerdicts&&!r.ui.showVerdictsInsideProgressBar&&o.length>0&&(t="<h5><span class='password-verdict'>"+o+"</span></h5>",n=!1),r.ui.showErrors&&(r.instances.errors.length>0&&(n=!1),t+=r.ui.popoverError(r.instances.errors)),n?void e.popover("hide"):void(s.$arrow&&s.$arrow.parents("body").length>0?e.find("+ .popover .popover-content").html(t):(s.options.content=t,e.popover("show")))},e.updateFieldStatus=function(e,s,t){var n=".postfix",i=s.parents(n).first()
r.each(o,function(r,e){i.removeClass(e)}),t=o[t],i.addClass(t)},e.percentage=function(r,e){var o=Math.floor(100*r/e)
return o=o<=0?1:o,o=o>100?100:o},e.getVerdictAndCssClass=function(r,e){var o,s,t
return e<=0?(o=0,t=-1,s=r.ui.verdicts[0]):e<r.ui.scores[0]?(o=0,t=0,s=r.ui.verdicts[0]):e<r.ui.scores[1]?(o=0,t=1,s=r.ui.verdicts[1]):e<r.ui.scores[2]?(o=1,t=2,s=r.ui.verdicts[2]):e<r.ui.scores[3]?(o=1,t=3,s=r.ui.verdicts[3]):(o=2,t=4,s=r.ui.verdicts[4]),[s,o,t]},e.updateUI=function(r,o,s){var t,n,i,a
t=e.getVerdictAndCssClass(r,s),i=0===s?"":t[0],t=t[1],a=r.ui.useVerdictCssClass?t:-1,r.ui.showProgressBar&&(n=e.percentage(s,r.ui.scores[3]),e.updateProgressBar(r,o,t,n),r.ui.showVerdictsInsideProgressBar&&e.updateVerdict(r,o,a,i)),r.ui.showStatus&&e.updateFieldStatus(r,o,t),r.ui.showPopover?e.updatePopover(r,o,i):(r.ui.showVerdicts&&!r.ui.showVerdictsInsideProgressBar&&e.updateVerdict(r,o,a,i),r.ui.showErrors&&e.updateErrors(r,o))}}(r,t)
var n={}
!function(r,o){"use strict"
var n,i
n=function(o){var s,n,i,a,c=r(o.target),u=c.data("pwstrength-foundation"),d=c.val()
void 0!==u&&(u.instances.errors=[],0===d.length?a=0:u.common.zxcvbn?(s=[],r.each(u.common.userInputs.concat([u.common.usernameField]),function(e,o){var t=r(o).val()
t&&s.push(t)}),s=s.concat(u.common.zxcvbnTerms),a=zxcvbn(d,s).entropy):a=e.executeRules(u,d),t.updateUI(u,c,a),n=t.getVerdictAndCssClass(u,a),i=n[2],n=n[0],u.common.debug&&console.log(a+" - "+n),r.isFunction(u.common.onKeyUp)&&u.common.onKeyUp(o,{score:a,verdictText:n,verdictLevel:i}))},o.init=function(e){return this.each(function(o,i){var a=r.extend(!0,{},s),c=r.extend(!0,a,e),u=r(i)
c.instances={},u.data("pwstrength-foundation",c),u.on("keyup",n),u.on("change",n),u.on("onpaste",n),t.initUI(c,u),r.trim(u.val())&&u.trigger("keyup"),r.isFunction(c.common.onLoad)&&c.common.onLoad()}),this},o.destroy=function(){this.each(function(e,o){var s=r(o),n=s.data("pwstrength-foundation"),i=t.getUIElements(n,s)
i.$progressbar.remove(),i.$verdict.remove(),i.$errors.remove(),s.removeData("pwstrength-foundation")})},o.forceUpdate=function(){this.each(function(r,e){var o={target:e}
n(o)})},o.addRule=function(e,o,s,t){this.each(function(n,i){var a=r(i).data("pwstrength-foundation")
a.rules.activated[e]=t,a.rules.scores[e]=s,a.rules.extra[e]=o})},i=function(e,o,s){this.each(function(t,n){r(n).data("pwstrength-foundation").rules[o][e]=s})},o.changeScore=function(r,e){i.call(this,r,"scores",e)},o.ruleActive=function(r,e){i.call(this,r,"activated",e)},r.fn.pwstrength=function(e){var s
return o[e]?s=o[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?r.error("Method "+e+" does not exist on jQuery.pwstrength-foundation"):s=o.init.apply(this,arguments),s}}(r,n)}(jQuery)
